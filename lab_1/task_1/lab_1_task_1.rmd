---
title: "Лабораторная работа 1, задание 1"
output: html_notebook
editor_options: 
  markdown: 
    wrap: 72
---

### Задание 1.

Файл с данными lab1_e1.csv. Мы видим, что в некоторых значениях числовых
переменных добавлен пробел между цифрами. В результате R определит такие
переменные как строку (или как фактор по умолчанию). Ваша задача
написать функцию fix_data, которая полу чает на вход набор данных, у
которого в некоторых значениях числовых переменных добавлен пробел между
цифрами. Ваша задача - избавиться от этого пробела и вернуть числовым
переменным их числовой тип. Функция должна возвращать преобразованный
набор данных, в котором все числовые переменные будут переведены в
числовой тип, при этом те переменные, которые действительно являются
строковыми (например, V2 и V4) никак преобразовывать не надо.

```{r warning=FALSE}
fix_data <- function(input_data) {
  convert <- function(data) {
    new_elem = as.numeric(gsub(' ', '', data))
    if (!any(is.na(new_elem))) {
      data = new_elem
    }
    return(data)
  }
  
  output_data <- (apply(input_data, 2, convert))
  return(output_data)
}

setwd(getwd())

data <- read.csv(file = 'data/lab1_e1.csv')
new_data <- fix_data(data)
write.csv(new_data, "data/lab1_e1_result.csv")
```
